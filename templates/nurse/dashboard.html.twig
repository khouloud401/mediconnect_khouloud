{% extends 'base.html.twig' %}

{% block title %}Mon Compte - MediConnect{% endblock %}

{% block body %}
    <style>
        :root {
            --violet-primary: #8e44ad;
            --violet-deep: #6c3483;
            --violet-light: #f4eef8;
            --glass-white: rgba(255, 255, 255, 0.92);
        }

        body {
            /* Changement de l'image de fond ici */
            background: url("{{ asset('images/image1.jpg') }}") no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            font-family: 'Poppins', sans-serif;
            color: #2d3436;
        }

        .dashboard-wrapper {
            padding: 50px 0;
            min-height: 100vh;
            /* Overlay pour amÃ©liorer la lisibilitÃ© sur image8 */
            background: rgba(0, 0, 0, 0.2);
        }

        /* Titre Bienvenue */
        .welcome-title {
            color: white;
            text-shadow: 0 4px 15px rgba(0,0,0,0.4);
            font-weight: 800;
            font-size: 2.8rem;
            margin-bottom: 40px;
            text-align: left;
        }

        /* Design des cartes Bento */
        .bento-card {
            background: var(--glass-white);
            backdrop-filter: blur(12px);
            border-radius: 30px;
            padding: 35px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .bento-card:hover {
            transform: translateY(-5px);
        }

        /* Avatar circulaire avec dÃ©gradÃ© */
        .nurse-avatar-container {
            width: 120px;
            height: 120px;
            padding: 5px;
            background: linear-gradient(135deg, var(--violet-primary), #a29bfe);
            border-radius: 50%;
            margin: 0 auto 20px;
            box-shadow: 0 8px 20px rgba(142, 68, 173, 0.4);
        }

        .nurse-avatar-container img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: white;
            object-fit: cover;
        }

        /* Bouton Violet */
        .btn-violet {
            background: var(--violet-primary);
            color: white;
            border-radius: 15px;
            padding: 12px 25px;
            border: none;
            font-weight: 600;
            transition: 0.3s;
            width: 100%;
            display: block;
            text-decoration: none;
            text-align: center;
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3);
        }

        .btn-violet:hover {
            background: var(--violet-deep);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(142, 68, 173, 0.4);
        }

        /* Planning Design */
        .planning-row {
            background: var(--violet-light);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border: 1px solid rgba(142, 68, 173, 0.1);
        }

        .shift-pill {
            background: white;
            color: var(--violet-primary);
            padding: 8px 18px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.85rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        /* TÃ¢ches de soins */
        .task-item {
            border-left: 5px solid var(--violet-primary);
            background: white;
            margin-bottom: 12px;
            padding: 18px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .task-patient { font-weight: 700; color: var(--violet-deep); }

        footer { display: none !important; }
    </style>

    <div class="dashboard-wrapper">
        <div class="container">

            {# Titre sans icÃ´ne #}
            <h1 class="welcome-title">Bienvenue dans votre compte</h1>

            <div class="row">
                {# Profil Gauche #}
                <div class="col-lg-4">
                    <div class="bento-card text-center">
                        <div class="nurse-avatar-container">
                            <img src="https://ui-avatars.com/api/?name={{ nurse.fullName }}&background=fff&color=8e44ad&size=128" alt="Avatar">
                        </div>
                        <h4 class="fw-bold mb-1">{{ nurse.fullName }}</h4>
                        <p class="text-muted small mb-4">Ã‰quipe nÂ°{{ nurse.teamNumber }} â€¢ {{ nurse.nomHopital }}</p>

                        <div class="text-start mb-4">
                            <div class="d-flex align-items-center mb-2">
                                <i class="bi bi-envelope-fill me-2 text-primary opacity-50"></i>
                                <span class="small">{{ nurse.email }}</span>
                            </div>
                            <div class="d-flex align-items-center">
                                <i class="bi bi-telephone-fill me-2 text-primary opacity-50"></i>
                                <span class="small">{{ nurse.phone }}</span>
                            </div>
                        </div>

                        <a href="{{ path('app_nurse_edit', {id: nurse.id}) }}" class="btn-violet">
                            Modifier mon profil
                        </a>
                    </div>
                </div>

                {# Contenu Droite #}
                <div class="col-lg-8">

                    {# Planning #}
                    <div class="bento-card">
                        <h5 class="fw-bold mb-4" style="color: var(--violet-deep);">Aujourd'hui</h5>
                        <div class="planning-row">
                            <div>
                                <span class="d-block small text-muted text-capitalize">{{ "now"|date("l") }}</span>
                                <span class="fw-bold" style="font-size: 1.1rem;">{{ "now"|date("d F Y") }}</span>
                            </div>
                            <div>
                                {% if nurse.shift == 'morning' %}
                                    <span class="shift-pill">ðŸŒž MATIN (07h-15h)</span>
                                {% elseif nurse.shift == 'evening' %}
                                    <span class="shift-pill">ðŸŒ‡ SOIR (15h-23h)</span>
                                {% else %}
                                    <span class="shift-pill">ðŸŒ™ NUIT (23h-07h)</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    {# Soins #}
                    <div class="bento-card">
                        <h5 class="fw-bold mb-4" style="color: var(--violet-deep);">Soins Ã  administrer</h5>

                        {% if tasks is empty %}
                            <p class="text-muted text-center py-3">Aucune tÃ¢che prÃ©vue pour le moment.</p>
                        {% else %}
                            {% for task in tasks %}
                                <div class="task-item shadow-sm">
                                    <div>
                                        <div class="task-patient">{{ task.patientName }}</div>
                                        <div class="small text-muted">{{ task.description }}</div>
                                    </div>
                                    <div>
                                        {% if task.status != 'TerminÃ©' %}
                                            <form method="post" action="{{ path('app_nurse_complete_task', {'id': task.id}) }}">
                                                <button type="submit" class="btn btn-sm btn-outline-primary rounded-pill px-3">
                                                    Valider
                                                </button>
                                            </form>
                                        {% else %}
                                            <span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3 py-2">
                                                <i class="bi bi-check-lg"></i> Fait
                                            </span>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}